Initialized word embeddings
Obtained embeddings
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            (None, 10)           0                                            
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 4096)         0                                            
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 10, 300)      4798800     input_1[0][0]                    
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 300)          1229100     input_2[0][0]                    
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 3000)         0           embedding_1[0][0]                
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 3300)         0           dense_1[0][0]                    
                                                                 reshape_1[0][0]                  
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 5000)         16505000    concatenate_1[0][0]              
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 500)          2500500     dense_2[0][0]                    
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 1)            501         dense_3[0][0]                    
==================================================================================================
Total params: 25,033,901
Trainable params: 25,033,901
Non-trainable params: 0
__________________________________________________________________________________________________
None
Built Model
Training now...
Epoch 1/15
14105/14105 [==============================] - 734s 52ms/step - loss: 0.2583 - acc: 0.9230 - val_loss: 0.2258 - val_acc: 0.9329
Epoch 2/15
14105/14105 [==============================] - 733s 52ms/step - loss: 0.2164 - acc: 0.9353 - val_loss: 0.2142 - val_acc: 0.9355
Epoch 3/15
14105/14105 [==============================] - 740s 52ms/step - loss: 0.2078 - acc: 0.9382 - val_loss: 0.2090 - val_acc: 0.9374
Epoch 4/15
14105/14105 [==============================] - 735s 52ms/step - loss: 0.2031 - acc: 0.9394 - val_loss: 0.2089 - val_acc: 0.9378
Epoch 5/15
14105/14105 [==============================] - 734s 52ms/step - loss: 0.1999 - acc: 0.9405 - val_loss: 0.2068 - val_acc: 0.9394
Epoch 6/15
14105/14105 [==============================] - 735s 52ms/step - loss: 0.1974 - acc: 0.9412 - val_loss: 0.2014 - val_acc: 0.9400
Epoch 7/15
14105/14105 [==============================] - 735s 52ms/step - loss: 0.1947 - acc: 0.9419 - val_loss: 0.2047 - val_acc: 0.9386
Epoch 8/15
14105/14105 [==============================] - 733s 52ms/step - loss: 0.1935 - acc: 0.9423 - val_loss: 0.2049 - val_acc: 0.9401
Epoch 9/15
14105/14105 [==============================] - 734s 52ms/step - loss: 0.1918 - acc: 0.9429 - val_loss: 0.2029 - val_acc: 0.9398
Epoch 10/15
14105/14105 [==============================] - 734s 52ms/step - loss: 0.1906 - acc: 0.9433 - val_loss: 0.2027 - val_acc: 0.9400
Epoch 11/15
14105/14105 [==============================] - 734s 52ms/step - loss: 0.1894 - acc: 0.9437 - val_loss: 0.2045 - val_acc: 0.9409
Epoch 12/15
14105/14105 [==============================] - 737s 52ms/step - loss: 0.1883 - acc: 0.9440 - val_loss: 0.2003 - val_acc: 0.9408
Epoch 13/15
14105/14105 [==============================] - 740s 52ms/step - loss: 0.1874 - acc: 0.9443 - val_loss: 0.2024 - val_acc: 0.9400
Epoch 14/15
14105/14105 [==============================] - 737s 52ms/step - loss: 0.1865 - acc: 0.9447 - val_loss: 0.2042 - val_acc: 0.9396
Epoch 15/15
14105/14105 [==============================] - 730s 52ms/step - loss: 0.1856 - acc: 0.9449 - val_loss: 0.1995 - val_acc: 0.9419
14105/14105 [==============================] - 188s 13ms/step

Metrics on first order train dataset
precision: [ 0.9377438   0.98174319]
recall: [ 0.99497635  0.80352106]
fscore: [ 0.96551268  0.88373621]
support: [1055607  354893]
[[1050304    5303]
 [  69729  285164]]
Accuracy = (1050304.0 + 285164.0)/(1050304.0 + 285164.0 + 5303.0 + 69729.0) = 0.9468046791917759
2821/2821 [==============================] - 36s 13ms/step
Metrics on first order val dataset
precision: [ 0.93369348  0.97345709]
recall: [ 0.99273585  0.79074766]
fscore: [ 0.96230988  0.87264125]
support: [263761  88864]
[[261845   1916]
 [ 18595  70269]]
Accuracy = (261845.0 + 70269.0)/(261845.0 + 70269.0 + 1916.0 + 18595.0) = 0.9418333924140376
113489/113489 [==============================] - 269s 2ms/step
Metrics on first order test dataset
precision: [ 0.93175649  0.75502258]
recall: [ 0.92162155  0.78159493]
fscore: [ 0.92666131  0.768079  ]
support: [693558 214354]
[[639198  54360]
 [ 46816 167538]]
Accuracy = (639198.0 + 167538.0)/(639198.0 + 167538.0 + 54360.0 + 46816.0) = 0.8885618870551331
601/601 [==============================] - 7s 12ms/step
Metrics on qrpe train dataset
precision: [ 0.6242502   0.86241169]
recall: [ 0.93507007  0.41964806]
fscore: [ 0.74868222  0.56457492]
support: [35392 34324]
[[33094  2298]
 [19920 14404]]
Accuracy = (33094.0 + 14404.0)/(33094.0 + 14404.0 + 2298.0 + 19920.0) = 0.6813070170405646
314/314 [==============================] - 4s 12ms/step
Metrics on qrpe test dataset
precision: [ 0.58084634  0.68006818]
recall: [ 0.82631178  0.38239937]
fscore: [ 0.6821695   0.48953522]
support: [18372 17738]
[[15181  3191]
 [10955  6783]]
Accuracy = (15181.0 + 6783.0)/(15181.0 + 6783.0 + 3191.0 + 10955.0) = 0.6082525616172806
6683/6683 [==============================] - 60s 9ms/step
Metrics on second train dataset
precision: [ 0.1862989  0.8341657]
recall: [ 0.22250586  0.80096314]
fscore: [ 0.20279899  0.81722732]
support: [ 90883 443757]
[[ 20222  70661]
 [ 88324 355433]]
 Accuracy = (20222.0 + 355433.0)/(20222.0 + 355433.0 + 70661.0 + 88324.0) = 0.7026316773903936
 23431/23431 [==============================] - 83s 4ms/step
Metrics on second test dataset
precision: [ 0.09794017  0.91550343]
recall: [ 0.2263808   0.80079975]
fscore: [ 0.13672735  0.85431866]
support: [ 42910 449141]
[[  9714  33196]
 [ 89469 359672]]
Accuracy = (9714.0 + 359672.0)/(9714.0 + 359672.0 + 33196.0 + 89469.0) = 0.7507067356839027