__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_2 (InputLayer)            (None, 4096)         0
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 300)          1229100     input_2[0][0]
__________________________________________________________________________________________________
input_1 (InputLayer)            (None, 10)           0
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1, 300)       0           dense_1[0][0]
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 10, 300)      4798800     input_1[0][0]
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 11, 300)      0           reshape_1[0][0]
                                                                 embedding_1[0][0]
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 512)          1665024     concatenate_1[0][0]
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 100)          51300       lstm_1[0][0]
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 50)           5050        dense_2[0][0]
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 1)            51          dense_3[0][0]
==================================================================================================
Total params: 7,749,325
Trainable params: 7,749,325
Non-trainable params: 0
__________________________________________________________________________________________________
None
Built Model
Training now...
Epoch 1/10
14105/14105 [==============================] - 674s 48ms/step - loss: 0.2102 - acc: 0.9360 - val_loss: 0.1718 - val_acc: 0.9490
Epoch 2/10
14105/14105 [==============================] - 672s 48ms/step - loss: 0.1611 - acc: 0.9528 - val_loss: 0.1554 - val_acc: 0.9546
Epoch 3/10
14105/14105 [==============================] - 673s 48ms/step - loss: 0.1484 - acc: 0.9567 - val_loss: 0.1525 - val_acc: 0.9557
Epoch 4/10
14105/14105 [==============================] - 674s 48ms/step - loss: 0.1427 - acc: 0.9584 - val_loss: 0.1490 - val_acc: 0.9569
Epoch 5/10
14105/14105 [==============================] - 674s 48ms/step - loss: 0.1386 - acc: 0.9597 - val_loss: 0.1483 - val_acc: 0.9572
Epoch 6/10
14105/14105 [==============================] - 674s 48ms/step - loss: 0.1367 - acc: 0.9602 - val_loss: 0.1448 - val_acc: 0.9583
Epoch 7/10
14105/14105 [==============================] - 674s 48ms/step - loss: 0.1352 - acc: 0.9607 - val_loss: 0.1475 - val_acc: 0.9577
Epoch 8/10
14105/14105 [==============================] - 672s 48ms/step - loss: 0.1345 - acc: 0.9608 - val_loss: 0.1491 - val_acc: 0.9577
Epoch 9/10
14105/14105 [==============================] - 671s 48ms/step - loss: 0.1357 - acc: 0.9604 - val_loss: 0.1482 - val_acc: 0.9576
Epoch 10/10
14105/14105 [==============================] - 671s 48ms/step - loss: 0.1357 - acc: 0.9604 - val_loss: 0.1487 - val_acc: 0.9572
14105/14105 [==============================] - 193s 14ms/step
Metrics on first order train dataset
precision: [ 0.95287814  0.98818885]
recall: [ 0.99657069  0.85341216]
fscore: [ 0.97423478  0.91586872]
support: [1055607  354893]
[[1051987    3620]
 [  52023  302870]]
Accuracy = (1051987.0 + 302870.0)/(3620.0 + 1051987.0 + 52023.0 + 302870.0) = 0.9605508684863524
2821/2821 [==============================] - 39s 14ms/step
Metrics on first order val dataset
precision: [ 0.94954304  0.98544986]
recall: [ 0.99580681  0.84293977]
fscore: [ 0.97212481  0.90864099]
support: [263761  88864]
[[262655   1106]
 [ 13957  74907]]
Accuracy = (262655.0 + 74907.0)/(262655.0 + 74907.0 + 1106.0 + 13957.0) = 0.9572832328961361
113489/113489 [==============================] - 874s 8ms/step
Metrics on first order test dataset
precision: [ 0.94595806  0.72167805]
recall: [ 0.90064998  0.83351839]
fscore: [ 0.92274819  0.77357678]
support: [693558 214354]
[[624653  68905]
 [ 35686 178668]]
Accuracy = (624653.0 + 178668.0)/(624653.0 + 178668.0 + 68905.0 + 35686.0) = 0.8848005093004608
601/601 [==============================] - 8s 13ms/step
Metrics on qrpe train dataset
precision: [ 0.69814343  0.89835152]
recall: [ 0.936059    0.58268267]
fscore: [ 0.79978273  0.70687614]
support: [35392 34324]
[[33129  2263]
 [14324 20000]]
Accuracy = (33129.0 + 20000.0)/(33129.0 + 20000.0 + 14324.0 + 2263.0) = 0.762077571862987
314/314 [==============================] - 4s 13ms/step
Metrics on qrpe test dataset
precision: [ 0.63541119  0.7084524 ]
recall: [ 0.78897235  0.53111963]
fscore: [ 0.70391414  0.60710143]
support: [18372 17738]
[[14495  3877]
 [ 8317  9421]]
Accuracy = (14495.0 + 9421.0)/(14495.0 + 9421.0 + 3877.0 + 8317.0) = 0.662309609526447
6683/6683 [==============================] - 78s 12ms/step
Metrics on second train dataset
precision: [ 0.21839462  0.83908677]
recall: [ 0.20285422  0.85131502]
fscore: [ 0.21033777  0.84515666]
support: [ 90883 443757]
[[ 18436  72447]
 [ 65980 377777]]
Accuracy = (18436.0 + 377777.0)/(18436.0 + 377777.0 + 72447.0 + 65980.0) = 0.7410837198862786
23431/23431 [==============================] - 187s 8ms/step
Metrics on second test dataset
precision: [ 0.11510335  0.91785934]
recall: [ 0.20284316  0.85101561]
fscore: [ 0.14686701  0.8831745 ]
support: [ 42910 449141]
[[  8704  34206]
 [ 66915 382226]]
Accuracy = (8704.0 + 382226.0)/(8704.0 + 382226.0 + 34206.0 + 66915.0) = 0.7944908149764963