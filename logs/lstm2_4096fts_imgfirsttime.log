__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
input_1 (InputLayer)            (None, 10)           0
__________________________________________________________________________________________________
input_2 (InputLayer)            (None, 4096)         0
__________________________________________________________________________________________________
embedding_1 (Embedding)         (None, 10, 300)      4798800     input_1[0][0]
__________________________________________________________________________________________________
dense_2 (Dense)                 (None, 300)          1229100     input_2[0][0]
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 10, 512)      1665024     embedding_1[0][0]
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 1, 300)       0           dense_2[0][0]
__________________________________________________________________________________________________
time_distributed_1 (TimeDistrib (None, 10, 300)      153900      lstm_1[0][0]
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 11, 300)      0           reshape_1[0][0]
                                                                 time_distributed_1[0][0]
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 512)          1665024     concatenate_1[0][0]
__________________________________________________________________________________________________
dense_3 (Dense)                 (None, 100)          51300       lstm_2[0][0]
__________________________________________________________________________________________________
dense_4 (Dense)                 (None, 50)           5050        dense_3[0][0]
__________________________________________________________________________________________________
dense_5 (Dense)                 (None, 1)            51          dense_4[0][0]
==================================================================================================
Total params: 9,568,249
Trainable params: 9,568,249
Non-trainable params: 0
__________________________________________________________________________________________________
None
Built Model
Training now...
Epoch 1/8
14105/14105 [==============================] - 1116s 79ms/step - loss: 0.2114 - acc: 0.9353 - val_loss: 0.1726 - val_acc: 0.9489
Epoch 2/8
14105/14105 [==============================] - 1100s 78ms/step - loss: 0.1625 - acc: 0.9521 - val_loss: 0.1587 - val_acc: 0.9533
Epoch 3/8
14105/14105 [==============================] - 1099s 78ms/step - loss: 0.1509 - acc: 0.9556 - val_loss: 0.1566 - val_acc: 0.9537
Epoch 4/8
14105/14105 [==============================] - 1103s 78ms/step - loss: 0.1460 - acc: 0.9570 - val_loss: 0.1498 - val_acc: 0.9562
Epoch 5/8
14105/14105 [==============================] - 1103s 78ms/step - loss: 0.1423 - acc: 0.9583 - val_loss: 0.1486 - val_acc: 0.9569
Epoch 6/8
14105/14105 [==============================] - 1106s 78ms/step - loss: 0.1397 - acc: 0.9590 - val_loss: 0.1488 - val_acc: 0.9576
Epoch 7/8
14105/14105 [==============================] - 1118s 79ms/step - loss: 0.1383 - acc: 0.9596 - val_loss: 0.1492 - val_acc: 0.9571
Epoch 8/8
14105/14105 [==============================] - 1116s 79ms/step - loss: 0.1388 - acc: 0.9596 - val_loss: 0.1487 - val_acc: 0.9570
14105/14105 [==============================] - 290s 21ms/step
Metrics on first order train dataset
precision: [ 0.95096697  0.99165688]
recall: [ 0.99760422  0.84700177]
fscore: [ 0.97372749  0.91363901]
support: [1055607  354893]
[[1053078    2529]
 [  54298  300595]]
Accuracy = (1053078.0 + 300595.0)/(1053078.0 + 300595.0 + 2529.0 + 54298.0) = 0.9597114498404821
2821/2821 [==============================] - 60s 21ms/step
Metrics on first order val dataset
precision: [ 0.94822115  0.98929771]
recall: [ 0.9969442   0.83841601]
fscore: [ 0.97197246  0.90762905]
support: [263761  88864]
[[262955    806]
 [ 14359  74505]]
Accuracy = (262955.0 + 74505.0)/(262955.0 + 74505.0 + 806.0 + 14359.0) = 0.9569939737681673
113489/113489 [==============================] - 1564s 14ms/step
Metrics on first order test dataset
precision: [ 0.94406643  0.73265594]
recall: [ 0.90682827  0.8261614 ]
fscore: [ 0.92507275  0.77660421]
support: [693558 214354]
[[628938  64620]
 [ 37263 177091]]
Accuracy = (628938.0 + 177091.0)/(628938.0 + 177091.0 + 64620.0 + 37263.0) = 0.8877831772242244
601/601 [==============================] - 13s 21ms/step
Metrics on qrpe train dataset
precision: [ 0.69028483  0.89676319]
recall: [ 0.93673712  0.56662976]
fscore: [ 0.79484536  0.69445833]
support: [35392 34324]
[[33153  2239]
 [14875 19449]]
Accuracy = (33153.0 + 19449.0)/(33153.0 + 19449.0 + 2239.0 + 14875.0) = 0.7545183315164381
314/314 [==============================] - 7s 21ms/step
Metrics on qrpe test dataset
precision: [ 0.62895067  0.70533857]
recall: [ 0.79180274  0.51617995]
fscore: [ 0.70104335  0.59611315]
support: [18372 17738]
[[14547  3825]
 [ 8582  9156]]
Accuracy = (14547.0 + 9156.0)/(14547.0 + 9156.0 + 3825.0 + 8582.0) = 0.6564109664912766
6683/6683 [==============================] - 124s 18ms/step
Metrics on second train dataset
precision: [ 0.21549202  0.83891717]
recall: [ 0.20750855  0.84528244]
fscore: [ 0.21142495  0.84208778]
support: [ 90883 443757]
[[ 18859  72024]
 [ 68657 375100]]
Accuracy = (18859.0 + 375100.0)/(18859.0 + 375100.0 + 72024.0 + 68657.0) = 0.7368677988927128
23431/23431 [==============================] - 328s 14ms/step
Metrics on second test dataset
precision: [ 0.11273404  0.91763622]
recall: [ 0.20612911  0.84500636]
fscore: [ 0.14575386  0.87982493]
support: [ 42910 449141]
[[  8845  34065]
 [ 69614 379527]]
Accuracy = (8845.0 + 379527.0)/(8845.0 + 379527.0 + 34065.0 + 69614.0) = 0.7892921668688815